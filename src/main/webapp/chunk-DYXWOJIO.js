import{a as we,b as be}from"./chunk-5ZBO4QJK.js";import{b as Y,c as Z,d as $,f as ie,g as oe,h as re,i as ne,j as ae,k as le,l as se,n as de,o as ce,p as pe,q as ue,r as me,s as _e,t as Ce,u as fe,v as xe,w as Se}from"./chunk-JW6GJDIX.js";import"./chunk-7O5A32FW.js";import{B as ge,C as he,D as ye,b as H,e as z,i as O,m as G,o as K,r as Q,t as X,w as ee,x as te}from"./chunk-PXTB3HIE.js";import{Eb as q,Gb as N,Oc as P,Pa as D,Ra as m,Sc as I,Ua as M,Va as E,Wa as n,X as W,Xa as r,Xc as J,Ya as g,ab as y,bb as f,cb as c,ea as s,ec as R,fa as d,kb as F,lb as p,lc as A,mb as w,mc as U,nb as k,qb as h,rb as _,sb as C,tb as B,ub as L,uc as j,vb as v,ya as a,za as S}from"./chunk-GKGXNZWZ.js";import{a as V}from"./chunk-55KE2TB7.js";var De=()=>["title","price","category","partidaDescription"],ve=()=>({width:"450px",height:"550px"}),Pe=()=>({width:"450px"});function Ie(l,u){}function Me(l,u){if(l&1){let o=y();n(0,"div",15)(1,"h5",16),p(2,"Cat\xE1logo de productos"),r()(),n(3,"div",3)(4,"div",17)(5,"p-dropdown",18),C("ngModelChange",function(e){s(o);let i=c();return _(i.selectedPartidaFilter,e)||(i.selectedPartidaFilter=e),d(e)}),f("onChange",function(){s(o);let e=c();return d(e.onChangeDrops())}),r()(),n(6,"div",17)(7,"p-dropdown",19),C("ngModelChange",function(e){s(o);let i=c();return _(i.selectedDestinationFilter,e)||(i.selectedDestinationFilter=e),d(e)}),f("onChange",function(){s(o);let e=c();return d(e.onChangeDrops())}),r()(),n(8,"div",20)(9,"span",21),g(10,"i",22),n(11,"input",23),f("input",function(e){s(o),c();let i=F(8);return d(i.filterGlobal(e.target.value,"contains"))}),r()()()()}if(l&2){let o=c();a(5),m("options",o.partidas),h("ngModel",o.selectedPartidaFilter),m("showClear",!0),a(2),h("ngModel",o.selectedDestinationFilter),m("options",o.destinations)("showClear",!0)}}function Ee(l,u){l&1&&(n(0,"tr")(1,"th",24),g(2,"p-tableHeaderCheckbox"),r(),n(3,"th",25),p(4,"Producto "),g(5,"p-sortIcon",26),r(),n(6,"th",27),p(7,"Precio "),g(8,"p-sortIcon",28),r(),n(9,"th",29),p(10,"Unidad "),g(11,"p-sortIcon",30),r(),n(12,"th",31),p(13,"Partida "),g(14,"p-sortIcon",32),r(),n(15,"th",31),p(16,"Especializado para "),g(17,"p-sortIcon",33),r(),g(18,"th"),r())}function Te(l,u){if(l&1){let o=y();n(0,"tr")(1,"td"),g(2,"p-tableCheckbox",34),r(),n(3,"td"),p(4),r(),n(5,"td"),p(6),q(7,"currency"),r(),n(8,"td"),p(9),r(),n(10,"td")(11,"span"),p(12),r()(),n(13,"td")(14,"span"),p(15),r()(),n(16,"td")(17,"button",35),f("click",function(){let e=s(o).$implicit,i=c();return d(i.editProduct(e))}),r(),n(18,"button",36),f("click",function(){let e=s(o).$implicit,i=c();return d(i.deleteProduct(e))}),r()()()}if(l&2){let o=u.$implicit;a(2),m("value",o),a(2),w(o.title),a(2),w(N(7,10,o.price,"USD")),a(3),w(o.categoryDescription),a(2),E("product-badge status-"),a(),w(o.partidaDescription),a(2),E("product-badge status-"),a(),w(o.areaDescription)}}function Ve(l,u){if(l&1&&(n(0,"div",15),p(1),r()),l&2){let o=c();a(),k(" En total hay ",o.products?o.products.length:0," productos. ")}}function We(l,u){l&1&&(n(0,"small",51),p(1,"Nombre del producto es requerido."),r())}function Fe(l,u){if(l&1){let o=y();n(0,"div",37)(1,"label",38),p(2,"Producto:"),r(),n(3,"input",39),C("ngModelChange",function(e){s(o);let i=c();return _(i.product.title,e)||(i.product.title=e),d(e)}),r(),D(4,We,2,0,"small",40),r(),n(5,"div",37)(6,"label",41),p(7,"Descripci\xF3n:"),r(),n(8,"textarea",42),C("ngModelChange",function(e){s(o);let i=c();return _(i.product.description,e)||(i.product.description=e),d(e)}),r()(),n(9,"div",37)(10,"div",43)(11,"div",44)(12,"label",45),p(13,"Partidas:"),r(),n(14,"p-dropdown",46),C("ngModelChange",function(e){s(o);let i=c();return _(i.selectedPartida,e)||(i.selectedPartida=e),d(e)}),r()()()(),n(15,"div",37)(16,"div",43)(17,"div",44)(18,"label",45),p(19,"Unidades:"),r(),n(20,"p-dropdown",47),C("ngModelChange",function(e){s(o);let i=c();return _(i.selectedCategory,e)||(i.selectedCategory=e),d(e)}),r()()()(),n(21,"div",37)(22,"div",43)(23,"div",44)(24,"label",45),p(25,"Especializado para:"),r(),n(26,"p-dropdown",48),C("ngModelChange",function(e){s(o);let i=c();return _(i.selectedDestination,e)||(i.selectedDestination=e),d(e)}),r()()()(),n(27,"div",43)(28,"div",44)(29,"label",45),p(30,"Precio:"),r(),n(31,"p-inputNumber",49),C("ngModelChange",function(e){s(o);let i=c();return _(i.product.price,e)||(i.product.price=e),d(e)}),r()()(),n(32,"div",43)(33,"div",44)(34,"p-checkbox",50),C("ngModelChange",function(e){s(o);let i=c();return _(i.product.generateIva,e)||(i.product.generateIva=e),d(e)}),r()()()}if(l&2){let o=c();a(3),h("ngModel",o.product.title),a(),m("ngIf",o.submitted&&!o.product.title),a(4),h("ngModel",o.product.description),a(6),m("options",o.partidas),h("ngModel",o.selectedPartida),m("required",!0)("showClear",!0),a(6),m("options",o.unidades),h("ngModel",o.selectedCategory),m("showClear",!0),a(6),h("ngModel",o.selectedDestination),m("options",o.destinations)("showClear",!0),a(5),h("ngModel",o.product.price),a(3),m("binary",!0),h("ngModel",o.product.generateIva)}}function ke(l,u){if(l&1){let o=y();n(0,"button",52),f("click",function(){s(o);let e=c();return d(e.hideDialog())}),r(),n(1,"button",53),f("click",function(){s(o);let e=c();return d(e.saveProduct())}),r()}}var gt=(()=>{let u=class u{constructor(t,e,i,b){this.productService=t,this.catalogService=e,this.messageService=i,this.confirmationService=b,this.products=[],this.product={price:0,quantity:0,title:""},this.selectedProducts=[],this.submitted=!1,this.productDialog=!1,this.loadingProducts=!1,this.unidades=[],this.partidas=[],this.destinations=[],this.selectedDestinationFilter={areaId:"0",areaDescription:""},this.selectedPartida={partidaId:0,partidaDescription:""},this.selectedPartidaFilter={partidaId:0,partidaDescription:""},this.selectedCategory={categoryId:0,categoryDescription:""},this.selectedDestination={areaId:"0",areaDescription:""}}ngOnInit(){this.loadProducts(0,0),this.loadPartidaCatalog(),this.loadAreasCatalog(),this.loadCategoryCatalog(),console.log("area %o",this.destinations)}onChangeDrops(){let t=null;this.selectedDestinationFilter!=null&&(t=this.selectedDestinationFilter.areaId);let e=null;this.selectedPartidaFilter!=null&&(e=this.selectedPartidaFilter.partidaId),this.products=[],this.loadProducts(t,e)}openNew(){this.product={price:0,quantity:0,title:""},this.submitted=!1,this.productDialog=!0}deleteSelectedProducts(){this.confirmationService.confirm({message:"Estas seguro que quieres borrar el producto selecionado?",header:"Confirmaci\xF3n",icon:"pi pi-exclamation-triangle",accept:()=>{this.products=this.products.filter(t=>!this.selectedProducts.includes(t)),this.selectedProducts=[],this.messageService.add({severity:"success",summary:"Confirmaci\xF3n",detail:"Producto eliminado exitosamente",life:3e3})}})}editProduct(t){console.log("Destinations: ",this.destinations),console.log("Unidades: ",this.unidades),console.log("Partidas: ",this.partidas),this.product=V({},t),t.destinationId!=null?(console.log("ProductParam: %o",t),console.log("this.Product: %o",this.product),this.selectedDestination={areaId:t.destinationId,areaDescription:t.areaDescription},this.product.destinationId=t.destinationId,this.product.areaDescription=t.areaDescription):(this.product.destinationId=null,this.product.areaDescription=null),this.selectedPartida={partidaId:t.partidaId,partidaDescription:t.partidaDescription},this.selectedCategory={categoryId:t.categoryId,categoryDescription:t.categoryDescription},this.productDialog=!0,console.log("Selected destination: %o",this.selectedDestination),console.log("Selected partida: %o",this.selectedPartida),console.log("Selected category: %o",this.selectedCategory)}deleteProduct(t){this.confirmationService.confirm({message:"Estas seguro que quieres borrar el producto "+t.title+"?",header:"Confirm",icon:"pi pi-exclamation-triangle",accept:()=>{this.removeproduct(t.id),this.products=this.products.filter(e=>e.id!==t.id),this.product={price:0,quantity:0,title:""}}})}hideDialog(){this.productDialog=!1,this.submitted=!1}saveProduct(){this.submitted=!0,this.product.title.trim()&&(this.product.id?(this.selectedDestination!=null?(this.product.destinationId=this.selectedDestination.areaId,this.product.areaDescription=this.selectedDestination.areaDescription):(this.product.destinationId=null,this.product.areaDescription=null),this.product.categoryId=this.selectedCategory.categoryId,this.product.categoryDescription=this.selectedCategory.categoryDescription,this.product.partidaDescription=this.selectedPartida.partidaDescription,this.product.partidaId=this.selectedPartida.partidaId,this.addProduct(this.product),this.products[this.findIndexById(this.product.id)]=this.product,this.messageService.add({severity:"success",summary:"Actualizaci\xF3n exitosa",detail:"Se actualiz\xF3 el producto con \xE9xito",life:3e3})):(this.product.id="",this.selectedDestination!=null?(this.product.destinationId=this.selectedDestination.areaId,this.product.areaDescription=this.selectedDestination.areaDescription):(this.product.destinationId=null,this.product.areaDescription=null),this.product.categoryId=this.selectedCategory.categoryId,this.product.categoryDescription=this.selectedCategory.categoryDescription,this.product.partidaDescription=this.selectedPartida.partidaDescription,this.product.partidaId=this.selectedPartida.partidaId,this.addProduct(this.product),this.messageService.add({severity:"success",summary:"Creaci\xF3n exitosa",detail:"Se creo el prducto con \xE9xito"})),this.products=[...this.products],this.productDialog=!1,this.product={price:0,quantity:0,title:""})}addProduct(t){return console.log("param %o",t),this.catalogService.addProduct(t).subscribe({next:e=>{this.product=e},error:e=>{console.error("Error creating products:",e),this.messageService.add({severity:"error",summary:"Error al guardar",detail:"Ocurri\xF3 un error al guardar el prodcuto"})},complete:()=>{t.id==""&&(console.log("product %o",this.product),this.products.push(this.product))}}),""}removeproduct(t){this.catalogService.deleteProduct(t).subscribe({next:e=>{},error:e=>{console.error("Error deleting product:",e)},complete:()=>{}}),this.messageService.add({severity:"success",summary:"Confirmado",detail:"Se elimin\xF3 el producto con \xE9xito"})}findIndexById(t){let e=-1;for(let i=0;i<this.products.length;i++)if(this.products[i].id===t){e=i;break}return e}createId(){let t="";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<5;i++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}loadProducts(t,e){this.loadingProducts=!0,this.catalogService.getProductsCatalog(t,e).subscribe({next:i=>{i!=null&&(this.products=i)},error:i=>{console.error("Error loading products:",i)},complete:()=>{this.loadingProducts=!1}})}loadAreasCatalog(){let t;this.catalogService.getDestinations().subscribe({next:e=>{console.log("areas response %o ",e),this.destinations=e},error:e=>{console.error("Error loading areas catalog:",e)},complete:()=>{}})}loadPartidaCatalog(){this.catalogServicesSubscription=this.partidaCatSubscription=this.catalogService.getPartidas().subscribe({next:t=>{console.log(t),this.partidas=t},error:t=>{console.error("Error loading areas catalog:",t)},complete:()=>{}})}loadCategoryCatalog(){this.categoryCatSubscription=this.catalogService.getCategories().subscribe({next:t=>{this.unidades=t},error:t=>{console.error("Error loading areas catalog:",t)},complete:()=>{}})}ngOnDestroy(){this.catalogServicesSubscription?.unsubscribe(),this.partidaCatSubscription?.unsubscribe(),this.categoryCatSubscription?.unsubscribe(),console.log("unsubscribed")}};u.\u0275fac=function(e){return new(e||u)(S(ye),S(Se),S(I),S(P))},u.\u0275cmp=W({type:u,selectors:[["product-catalog-component"]],standalone:!0,features:[B([I,P]),L],decls:17,vars:17,consts:[["dt",""],[1,"card"],["styleClass","p-mb-4"],[1,"formgrid","grid"],[1,"field","md:col-12","col-12"],["pButton","","pRipple","","label","Nuevo","icon","pi pi-plus",1,"p-button-success","p-mr-2",3,"click"],["pTemplate","right"],["dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"selectionChange","value","rows","paginator","styleClass","globalFilterFields","selection","rowHover","showCurrentPageReport"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],["header","Detalles del producto","styleClass","p-fluid",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],[1,"p-d-flex","p-ai-center","p-jc-between"],[1,"p-m-0"],[1,"field","md:col-3","col-6"],["optionLabel","partidaDescription","placeholder","Selecciona una partida","pTooltip","Selecciona una partida para el producto",1,"p-inputtext-sm",3,"ngModelChange","onChange","options","ngModel","showClear"],["id","destiny","optionLabel","areaDescription","pTooltip","Selecciona un destino para los productos del cat\xE1logo","placeholder","Area de la remisi\xF3n",1,"p-inputtext-sm",3,"ngModelChange","onChange","ngModel","options","showClear"],[1,"field","md:col-6","col-12"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","B\xFAsqueda r\xE1pida...",1,"p-inputtext-sm",3,"input"],[2,"width","3rem"],["pSortableColumn","name"],["field","title"],["pSortableColumn","price"],["field","price"],["pSortableColumn","category"],["field","category"],["pSortableColumn","partidaDescription"],["field","partidaDescription"],["field","areaDescription"],[3,"value"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"click"],[1,"p-field"],["for","name"],["type","text","pInputText","","id","name","required","","autofocus","",3,"ngModelChange","ngModel"],["class","p-invalid",4,"ngIf"],["for","description"],["id","description","pInputTextarea","","rows","3","cols","20",3,"ngModelChange","ngModel"],[1,"p-formgrid","p-grid"],[1,"p-field","p-col"],["for","price"],["optionLabel","partidaDescription","placeholder","Selecciona una partida","pTooltip","Selecciona una partida para el producto",1,"p-inputtext-sm",3,"ngModelChange","options","ngModel","required","showClear"],["optionLabel","categoryDescription","placeholder","Selecciona una unidad","pTooltip","Selecciona una unidad para el producto",1,"p-inputtext-sm",3,"ngModelChange","options","ngModel","showClear"],["id","destiny","optionLabel","areaDescription","pTooltip","Selecciona un destino para los productos del cat\xE1logo","placeholder","Area de la remisi\xF3n",1,"p-inputtext-sm",3,"ngModelChange","ngModel","options","showClear"],["id","price","mode","currency","currency","USD","locale","en-US",3,"ngModelChange","ngModel"],["label","Aplica IVA",1,"p-inputtext-sm","text-xs",3,"ngModelChange","binary","ngModel"],[1,"p-invalid"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Guardar","icon","pi pi-check",1,"p-button-text",3,"click"]],template:function(e,i){if(e&1){let b=y();g(0,"p-toast"),n(1,"div",1)(2,"p-toolbar",2)(3,"div",3)(4,"div",4)(5,"button",5),f("click",function(){return s(b),d(i.openNew())}),r()()(),D(6,Ie,0,0,"ng-template",6),r(),n(7,"p-table",7,0),C("selectionChange",function(x){return s(b),_(i.selectedProducts,x)||(i.selectedProducts=x),d(x)}),D(9,Me,12,6,"ng-template",8)(10,Ee,19,0,"ng-template",9)(11,Te,19,13,"ng-template",10)(12,Ve,2,1,"ng-template",11),r()(),n(13,"p-dialog",12),C("visibleChange",function(x){return s(b),_(i.productDialog,x)||(i.productDialog=x),d(x)}),D(14,Fe,35,16,"ng-template",13)(15,ke,2,0,"ng-template",14),r(),g(16,"p-confirmDialog")}e&2&&(a(7),m("value",i.products)("rows",10)("paginator",!0)("styleClass","p-datatable-sm")("globalFilterFields",v(14,De)),h("selection",i.selectedProducts),m("rowHover",!0)("showCurrentPageReport",!0),a(6),M(v(15,ve)),h("visible",i.productDialog),m("modal",!0),a(3),M(v(16,Pe)))},dependencies:[U,R,A,de,re,J,ne,ae,le,se,Y,Q,Ce,_e,$,Z,X,he,ge,te,ee,j,pe,ce,K,H,z,G,O,oe,ie,me,ue,be,we,xe,fe]});let l=u;return l})();export{gt as ProductCatalogComponent};
